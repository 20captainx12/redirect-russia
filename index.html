<!DOCTYPE html>
<html lang="en" dir="ltr">
  <head>
    <meta charset="utf-8" />
    <title>Redirect Russia</title>
    <link rel="icon" type="image/png" href="/img/logo.png" />
    <link rel="stylesheet" href="/style.css" />
    <meta property="og:title" content="Redirect Russia" />
    <meta property="og:type" content="website" />
    <meta
      property="og:image"
      content="https://redirectrussia.org/img/banner.png"
    />
    <meta property="og:url" content="https://redirectrussia.org" />
    <meta name="twitter:card" content="summary_large_image" />
    <meta
      property="og:description"
      content="Redirect Russian traffic away from your website to support Ukraine."
    />
    <meta property="og:site_name" content="Redirect Russia" />
    <meta name="twitter:image:alt" content="Redirect Russia logo" />
    <link rel="canonical" href="https://redirectrussia.org" />
  </head>
  <body>
    <div class="hero" hidden>
      <div class="container">
        <h2>This site is not available in Russia.</h2>
        <p>
          Due to the Putin-initiated war in Ukraine, we have decided to take
          part in the sanctions against Russia and have disabled our services
          for visitors from Russia.
        </p>
        <p>
          <a href="https://helpukrainewin.org">
            Help end the war and support Ukraine &rarr;
          </a>
        </p>
      </div>
    </div>
    <main class="container">
      <img alt="" src="/img/logo.png" class="logo" />
      <h1>Redirect Russia</h1>
      <p>Redirect Russian traffic away from your website to support Ukraine.</p>
      <form onsubmit="return false">
        <details>
          <summary>Advanced configuration</summary>
          <form>
            <fieldset>
              <legend>Where should users be redirected to?</legend>
              <label>
                <input type="radio" value="" name="redirect-url" checked />
                <span>
                  Redirect Russia landing page (<a
                    href="https://redirectrussia.org/?ref=example.com"
                    target="_blank"
                    rel="noopener noreferrer"
                    >example</a
                  >)
                </span>
              </label>
              <label>
                <input type="radio" value="other" name="redirect-url" />
                <span>Custom URL</span>
              </label>
              <p>
                We redirect your users to a landing page which tells them that
                your site is unavailable in Russia and what they can do to help
                Ukraine. You can also set any custom redirection URL.
              </p>
            </fieldset>
            <label class="redirect-other other-label" hidden>
              <span>Custom URL</span>
              <input type="url" name="other-url" value="https://" />
            </label>
            <fieldset>
              <legend>Location detection method</legend>
              <label>
                <input
                  type="radio"
                  name="detection"
                  value="timezone-then-ip"
                  checked
                />
                <span>Check for timezone, then IP address</span>
              </label>
              <label>
                <input type="radio" name="detection" value="ip-only" />
                <span>Only check IP address</span>
              </label>
              <p>
                In order to save on network requests, we only query an IP
                geolocation service if the user's date/time settings are in
                Russia; if you disable this, you may be rate limited by your
                geolocation API service.
              </p>
            </fieldset>
            <fieldset>
              <legend>IP geolocation API</legend>
              <label>
                <input
                  type="radio"
                  name="geolocation"
                  value="https://api.country.is"
                  checked
                />
                <span>Country.is</span>
              </label>
              <label>
                <input type="radio" name="geolocation" value="other" />
                <span>Custom endpoint</span>
              </label>
              <p>
                By default, we use Country.is; but you can use any IP
                geolocation endpoint that returns the "country" field with an
                ISO 3166-1 alpha-2 country code.
              </p>
            </fieldset>
            <label class="ip-api-other other-label" hidden>
              <span>Custom URL</span>
              <input type="url" name="other-url" value="https://" />
            </label>
            <fieldset>
              <legend>Show domain on redirect</legend>
              <label>
                <input type="radio" name="domain" value="yes" checked />
                <span>Yes</span>
              </label>
              <label>
                <input type="radio" name="domain" value="no" />
                <span>No</span>
              </label>
              <p>
                If your site is example.com, the redirect page will say
                "example.com is not available in Russia" if you choose to show
                the domain (we'll add a <code>?ref</code> query parameter in the
                redirect URL). If you disable this, the message will be "This
                site is not available in Russia".
              </p>
            </fieldset>
          </form>
        </details>
        <output>
          <p>
            <strong>
              Copy and paste the following line on your website ðŸ‘‡
            </strong>
          </p>
          <pre><code id="result">&lt;script src="https://redirectrussia.org/v1.js" async&gt;&lt;/script&gt;</code></pre>
        </output>
      </form>
      <h2>How it works</h2>
      <img
        alt="Screenshot of redirect page"
        src="/img/screenshot.png"
        class="screenshot"
      />
      <p>
        When someone from Russia visits your website, they'll be redirected to a
        page that looks
        <a
          href="https://redirectrussia.org/?ref=example.com"
          target="_blank"
          rel="noopener noreferrer"
          >like this</a
        >.
      </p>
      <p>
        They can find information about how they can help Ukraine and make
        change from within Russia.
      </p>
      <footer>
        <p>
          From your friends at
          <a
            href="https://pabio.com/?utm_source=redirectrussia.org&utm_medium=footer-logo"
            target="_blank"
            rel="noopener noreferrer"
          >
            <img alt="Pabio" src="https://pabio.com/logo.svg" />
          </a>
        </p>
      </footer>
    </main>
    <script>
      window.addEventListener("DOMContentLoaded", (event) => {
        const searchParams = new URLSearchParams(window.location.search);
        if (searchParams.has("from")) {
          document.querySelector(".hero").removeAttribute("hidden");
          document.querySelector("main").setAttribute("hidden", "hidden");
          document.querySelector("body").style.backgroundColor = "#fcff63";
          document.querySelector(".hero h2").innerHTML = document
            .querySelector(".hero h2")
            .innerHTML.replace("This site", searchParams.get("from"));
        }

        const redirectUrls = document.querySelectorAll(
          'input[name="redirect-url"]'
        );
        const apiUrls = document.querySelectorAll('input[name="geolocation"]');
        const domainShow = document.querySelectorAll('input[name="domain"]');
        const detectionMethods = document.querySelectorAll(
          'input[name="detection"]'
        );
        const otherRedirect = document.querySelector(".redirect-other");
        const otherApi = document.querySelector(".ip-api-other");
        const result = document.querySelector("#result");

        let redirectUrl = "default";
        let otherRedirectUrl = "";
        let detection = "timezone-then-ip";
        let apiUrl = "https://api.country.is";
        let otherApiUrl = "";
        let showDomain = "yes";

        const update = () => {
          if (redirectUrl === "other") otherRedirect.removeAttribute("hidden");
          else otherRedirect.setAttribute("hidden", "hidden");

          if (apiUrl === "other") otherApi.removeAttribute("hidden");
          else otherApi.setAttribute("hidden", "hidden");

          result.innerHTML = `&lt;script src="https://redirectrussia.org/v1.js"${
            redirectUrl === "other" && otherRedirectUrl
              ? ` data-redirect-url="${otherRedirectUrl}"`
              : ""
          }${detection === "ip-only" ? ` data-detection="ip-only"` : ""}${
            apiUrl === "other" && otherApiUrl
              ? ` data-geolocation-api="${otherApiUrl}"`
              : ""
          }${
            showDomain === "no" ? ` data-hide-domain="hide"` : ""
          } async&gt;&lt;/script&gt;`;
        };

        redirectUrls.forEach((input) =>
          input.addEventListener("change", (event) => {
            redirectUrl = event.target.value;
            update();
          })
        );

        apiUrls.forEach((input) =>
          input.addEventListener("change", (event) => {
            apiUrl = event.target.value;
            update();
          })
        );

        domainShow.forEach((input) =>
          input.addEventListener("change", (event) => {
            showDomain = event.target.value;
            update();
          })
        );

        detectionMethods.forEach((input) =>
          input.addEventListener("change", (event) => {
            detection = event.target.value;
            update();
          })
        );

        otherRedirect
          .querySelector("input")
          .addEventListener("input", (event) => {
            otherRedirectUrl = event.target.value;
            update();
          });

        otherApi.querySelector("input").addEventListener("input", (event) => {
          otherApiUrl = event.target.value;
          update();
        });
      });
    </script>
    <script async src="v1.ts" data-detection="ip-only"></script>
    <script
      async
      src="https://www.googletagmanager.com/gtag/js?id=G-BCFFXV96LB"
    ></script>
    <script>
      window.dataLayer = window.dataLayer || [];
      function gtag() {
        dataLayer.push(arguments);
      }
      gtag("js", new Date());
      gtag("config", "G-BCFFXV96LB");
    </script>
  </body>
</html>
